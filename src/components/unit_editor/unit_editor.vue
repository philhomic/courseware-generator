<template>
  <div class="unit-editor-wrapper">
    <div class="left">
      <div class="menu question_type">
        <ul>
          <li class="type_item">
            <a href="javascript:;" @click="addBlock('radio')">单选题</a>
          </li>
          <li class="type_item">
            <a href="javascript:;" @click="addBlock('checkbox')">多选题</a>
          </li>
          <li class="type_item">
            <a href="javascript:;" @click="addBlock('selectsingle')">下拉题</a>
          </li>
        </ul>
      </div>
    </div>
    <div class="right">
      <ul class="page-tabs">
        <li class="page-tab" v-for="(page, pageIndex) in pages" :class="{'selectedTab': pageIndex === currentPageIndex}" @click="selectThisTab(pageIndex)">第 {{pageIndex + 1}} 页 <i class="icon-cross" @click.prevent.stop="deletePage(pageIndex)"></i></li>
        <li class="page-tab page-tab-plus" @click="addPage">+</li>
      </ul>
      <div class="page-editor-wrapper">
        <pageEditor :data="page" :pageIndex="currentPageIndex"></pageEditor>
      </div>
    </div>
    <router-view></router-view>
    <editorToolbar></editorToolbar>
  </div>
</template>

<script type="text/ecmascript-6">
  import pageEditor from '@/components/page_editor/page_editor';
  import editorToolbar from '@/components/editor_toolbar/editor_toolbar';

  export default {
    components: {
      pageEditor,
      editorToolbar
    },
    computed: {
      pages () {
        return this.$store.state.course.pages;
      },
      currentPageIndex () {
        return this.$store.state.currentPageIndex;
      },
      page () {
        return this.pages[this.currentPageIndex];
      }
    },
    methods: {
      addBlock (type) {
        this.$store.commit('addBlock', {
          type: type
        });
      },
      addPage () {
        this.$store.commit('addPage');
      },
      selectThisTab (pageIndex) {
        this.$store.state.currentPageIndex = pageIndex;
      },
      deletePage (pageIndex) {
        this.$store.commit('deletePage', {
          pageIndex: pageIndex
        });
      }
    }
  };
</script>

<style lang="stylus" rel="stylesheet/stylus">
  .unit-editor-wrapper
    .left
      position: absolute
      top: 0
      left: 0
      bottom: 0
      box-sizing: border-box
      width: 250px
      padding: 20px
      background-color: rgb(251,251,251)
      .menu
        position: fixed
        width: 210px
        overflow-y: auto
        .type_item
          cursor: pointer
          height: 38px
          line-height: 38px
          border: 1px solid #e0e0e0
          background-color: #fff
          margin-bottom: 3px
          a
            display: block
            height: 100%
            font-size: 14px
            color: #333
            padding-left: 20px
    .right
      margin-left: 250px
      border-left: 1px solid #e0e0e0
      min-height: 1000px
      .page-tabs
        width: 100%
        max-width: 1000px
        min-width: 320px
        margin-left: auto
        margin-right: auto
        font-size: 0
        .page-tab
          display: inline-block
          background: #fff
          width: 100px
          height: 40px
          line-height: 40px
          text-align: center
          font-size: 16px
          border: 1px solid #e0e0e0
          border-bottom: 1px solid rgba(224, 224, 224, 1)
          border-right: none
          cursor: pointer
          .icon-cross
            font-size: 10px
            border-radius: 50%
            padding: 4px
            background: #e0e0e0
            color: #fff
            &:hover
              background: red
        .page-tab-plus
          border-right: 1px solid #e0e0e0
        .page-tab.selectedTab
          border-bottom: 1px solid rgba(224, 224, 224, 0)
      .page-editor-wrapper
        max-width: 1000px
        min-width: 320px
        margin-left: auto
        margin-right: auto
        margin-top: -1px
        border-top: 1px solid #e0e0e0
</style>
